사이킷런 model_selection 모듈의 주요 기능

학습 데이터와 테스트 데이터 세트 분리
교차 검증 분할 및 평가
Estimator의 하이퍼 파라미터 튜닝 

하이퍼 파라미터 (Hyper Parameter) 

- 모델링할 때 사용자가 직접 세팅해주는 값
- 여러 하이퍼 파라미터를 순차적으로 변경하면서
- 최고 성능을 가지는 파라미터 조합을 찾을 수 있음
- max_depth, min_samples_split, iteration 등
- 머신러닝 알고리즘을 구성하는 주요 구성요소로
- 이 값들을 조정해서 알고리즘의 예측 성능을 개선할 수 있음

GridSearchCV 클래스
- 사이킷런에서는 GridSearchCV 클래스를 이용해서
- Classifier나 Regressor 같은 알고리즘에 사용되는
- 하이퍼 파라미터를 순차적으로 입력하면서
- 최적의 파라미터를 편리하게 도출할 수 있는 방법 제공

일반적인 머신러닝 모델 적용 방법
- 일반적으로 학습 데이터를 GridSearchCV를 이용해서
- 최적 하이퍼 파라미터 튜닝을 수행한 뒤에
- 별도의 테스트 세트에서 이를 평가하는 방식


## 데이터 전처리

기본 데이터 전처리 사항
- 결손값 / 문자열 값 처리
- 이상치 제거
- 피처 선택

데이터 인코딩
- 레이블 인코딩
- 원-핫 인코딩

피처 스케일링
- StandardScaler
- MinMaxScaler


문자열 값 처리
- 문자열 값을 입력 값으로 허용하지 않음
- 인코딩 처리하여 숫자형으로 변환


머신러닝의 대표적인 인코딩 방식
- 레이블 인코딩 (Label Encoding)
- 원-핫 인코딩 (One-Hot-Encoding)

레이블 인코딩
- 문자열 카테고리 값을 숫자형 카테고리 값으로 변환

### 원-핫 인코딩 (One-Hot Encoding)
- 행 형태의 피처값을 열 형태로 변환한 뒤
- 피처 값 인덱스 해당하는 컬럼에는 1로 표시하고
- 나머지 컬럼에는 0으로 표시하는 방식


원-핫 인코딩 과정
(1) 문자열 값을 숫자형 값으로 변환 (레이블 인코딩 사용)
(2) 입력 값을 2차원 데이터로 변환
(3) OneHotEncoder 클래스로 원-핫 인코딩 적용
- fit()
- transform()


피처 스케일링 (Feature Scaling)
- 서로 다른 변수의 값 번위를 일정한 수준으로 맞추는 작업
- 표준화 (Standardization)
- 정규화 (Nomalization)

표준화 (Standardization)
- 데이터의 피처 각 평균이 0이고 분산이 1인
- 가우시안 정규 분포(표준 정규 분포)를 가지는 값으로 변환하는 것

정규화 (Nomalization)
- 서로 다른 피처의 크기를 통일하기 위해 크기를 변환해주는 것

사이킷런에서 제공하는 대표적인 피처 스케일링 클래스
- StandardScaler
- MinMaxScaler

학습 데이터와 테스트 데이터의 스케일링 변환 시 유의점
- 학습 데이터와 테스트 데이터의 스케일링 기준 정보가 달라지지 않게 주의
- 머신러닝 모델은 학습 데이터를 기반으로 학습되기 대문에
- 반드시 테스트 데이터는 학습 데이터의 스케일러 기준에 따라야 함
- Scaler 객체를 이용해서 학습 데이터 세트로 fit()과 transform()을 적용하면
- 테스트 데이터에 다시 fit()을 적용해는 안 되며
- 학습 데이터로 이미 fit()이 적용된 Scaler 객체를 이용해서 transform으로 변환해야 함



사이킷런으로 수행하는 타이타닉 생존자 예측 과정
- 데이터 정보 확인
- 데이터 가공 (전처리)
    - Null 값 처리
    - Cabin 값 조정
    - 생존자 파악 (성별 / 객실등급별 / 연령별)
    - 레이블 인코딩
    - 모든 가공 내역을 함수로 작성
- 생존자 예측 프로세스
    - 클래스 결정값 데이터 세트 만들기
    - 학습/테스트 데이터 세트 분리
    - 예측 수행
    - 교차 검증
    - 하이퍼 파라미터 튜닝


## 정확도 (Accuracy)
- 실제 데이터에서 예측 데이터가 얼마나 같은지를 판단하는 지표
- 정확도 (Accuracy) = 예측 결과가 동일한 데이터 건수 / 전체 예측 데이터 건수
- 직관적으로 모델 예측 성능을 나타내는 평가 지표
- 그러나 이진 분류의 경우 데이터의 구성에 따라 ML 모델의 성능을 왜곡할 수 있기 때문에
- 정확도 수치 하나만 가지고 성능을 평가하지 않음
- 특히, 정확도는 불균형한 레이블 값 분포에서 ML 모델의 성능을 평가할경우
- 적합한 지표가 아님

분류의 성능 평가 지표
- 정확도 (Accuracy)
- 오차행렬 (Confusion Matrix)
- 정밀도 (Precision)
- 재현율 (Recall)
- F1 Score
- ROC AUC